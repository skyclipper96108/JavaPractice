<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>ajax</title>
	</head>
	<body>
		<form action="/reg" method="post">
			<h2>欢迎注册</h2>
			用户：<input name="username" id="username"/>
			<span id="span">
			</span>
			<br/><br/>
			密码：<input type="password" name="password" /><br/><br/>
			<input type="submit" value="提交"/>
		</form>
		
		
		<script type="text/javascript">
//			function getXhr(){
//				var xhr = new XMLHttpRequest();
//				return xhr;
//			}
//			// 1.获取ajax对象
//			// 2.准备请求
//			// 3.设置回调函数，接受服务器响应的数据
//			// 4.发送请求
//			var xhr = getXhr();
//			xhr.open("get","/test1");// 请求方式，请求地址
//			xhr.onreadystatechange = function(){
//				if(xhr.readyState==4)
//					alert(111);
//			}
//			xhr.send();
			var username = document.getElementById("username")
			//失去焦点事件
			username.onblur = function(){
				var xhr = new XMLHttpRequest();
				xhr.open("get","/checkName?username="+username.value);
				xhr.onreadystatechange=function(){
					if(xhr.readyState==4&&xhr.status==200){
						var msg = xhr.responseText;
						if(msg=='ok'){
							span.innerHTML='可以使用的名称';
							span.style.color='green';
						}else{
							span.innerHTML='不可以使用的名称';
							span.style.color='red';
						}
					}
				}
				xhr.send();
			}
		</script>
	</body>
</html>
